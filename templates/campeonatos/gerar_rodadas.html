{% extends 'base.html' %}

{% block title %}Gerar Rodadas - {{ campeonato.nome }}{% endblock title %}

{% block content %}
<div class="container-fluid">
	<!-- Header -->
	<div class="row mb-4">
		<div class="col-12">
			<div class="d-flex justify-content-between align-items-center">
				<div>
					<h1 class="h3 mb-1">Gerar Rodadas</h1>
					<p class="text-muted">{{ campeonato.nome }} - {{ campeonato.ano }}</p>
				</div>
				<a href="{% url 'configuracao_rodada' campeonato.id %}" class="btn btn-outline-secondary">
					<i class="fas fa-arrow-left"></i> 
					Voltar
				</a>
			</div>
		</div>
	</div>

	<!-- Card de Confirmação -->
	<div class="row justify-content-center">
		<div class="col-lg-8">
			<div class="card">
				<div class="card-header">
					<h5 class="card-title mb-0">
						<i class="fas fa-play"></i> 
						Confirmar Geração de Rodadas
					</h5>
				</div>
				<div class="card-body">
					<div class="alert alert-warning">
						<strong>
							Atenção!
						</strong> 
						Esta ação irá excluir todas as rodadas e partidas existentes e criar novas baseadas na configuração atual.
					</div>

					<div class="row">
						<div class="col-md-6">
							<h6>Configuração Atual:</h6>
							<ul class="list-unstyled">
								<li>
									<strong>Tipo:</strong> 
									{{ configuracao.get_tipo_configuracao_display }}
								</li>
								<li>
									<strong>Partidas por Rodada:</strong> 
									{{ configuracao.partidas_por_rodada }}
								</li>
								<li>
									<strong>Dias entre Rodadas:</strong> 
									{{ configuracao.dias_entre_rodadas }} dias
								</li>
								{% if configuracao.data_inicio_campeonato %}
									<li>
										<strong>Data de Início:</strong> 
										{{ configuracao.data_inicio_campeonato|date:"d/m/Y" }}
									</li>
								{% endif %}
							</ul>
						</div>

						<div class="col-md-6">
							<h6>Informações do Campeonato:</h6>
							<ul class="list-unstyled">
								<li>
									<strong>Total de Equipes:</strong> 
									{{ campeonato.total_equipes }}
								</li>
								<li>
									<strong>Total de Partidas:</strong>
									{% with total_equipes=campeonato.total_equipes %} 
										{% widthratio total_equipes total_equipes 1 as combinacoes %} 
										{% widthratio combinacoes 2 1 %} 
									{% endwith %}
								</li>
								<li>
									<strong>Rodadas Estimadas:</strong>
									{% with total_equipes=campeonato.total_equipes %}
										{% widthratio total_equipes total_equipes 1 as total_partidas %}
										{% widthratio total_partidas configuracao.partidas_por_rodada 1 %}
									{% endwith %}
								</li>
							</ul>
						</div>
					</div>

					{% if configuracao.tipo_configuracao == 'automatica' %}
						<div class="alert alert-info">
							<i class="fas fa-robot"></i>
							<strong>
								Modo Automático:
							</strong> 
							As partidas serão distribuídas aleatoriamente nas rodadas. Todas as equipes jogarão entre si.
						</div>
					{% else %}
						<div class="alert alert-info">
							<i class="fas fa-hand-paper"></i>
							<strong>
								Modo Manual:
							</strong> 
							Será criada a estrutura das rodadas. Você poderá adicionar as partidas manualmente.
						</div>
					{% endif %}

					<form method="post" class="mt-4">
						{% csrf_token %}

						<div class="d-flex gap-2 justify-content-end">
							<a href="{% url 'configuracao_rodada' campeonato.id %}" class="btn btn-secondary">
								<i class="fas fa-times"></i> 
								Cancelar
							</a>
							<button type="submit" class="btn btn-primary">
								<i class="fas fa-check"></i> 
								Confirmar e Gerar
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock content %}
